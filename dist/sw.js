(()=>{importScripts("https://storage.googleapis.com/workbox-cdn/releases/7.3.0/workbox-sw.js");const{precaching:e,routing:t,strategies:n,expiration:o,cacheableResponse:a}=workbox,{precacheAndRoute:s,createHandlerBoundToURL:i}=e,{registerRoute:r}=t,{CacheFirst:c,NetworkFirst:l,StaleWhileRevalidate:u}=n,{ExpirationPlugin:d}=o,{CacheableResponsePlugin:p}=a;async function m(e){try{const t=new FormData;return t.append("description",e.description||""),e.photo&&t.append("photo",e.photo,"photo.jpg"),void 0!==e.lat&&t.append("lat",e.lat),void 0!==e.lon&&t.append("lon",e.lon),(await fetch("https://story-api.dicoding.dev/v1/stories",{method:"POST",headers:e.token?{Authorization:`Bearer ${e.token}`}:{},body:t})).ok}catch(e){return!1}}s([{'revision':null,'url':'22c88b4abb7e3ccf0c99.png'},{'revision':null,'url':'2b3e1faf89f94a483539.png'},{'revision':null,'url':'416d91365b44e4b4f477.png'},{'revision':null,'url':'680f69f3c2e6b90c1812.png'},{'revision':'35639dd216b590b56cddfd953d02d831','url':'756.bundle.js'},{'revision':null,'url':'8f2c4d11474275fbc161.png'},{'revision':null,'url':'a0c6cc1401c107b501ef.png'},{'revision':'c5ed14868a2a5268d5b0c0ed4deb7ee6','url':'app.bundle.js'},{'revision':'a09afd57099dc21e9263ff61a08dff24','url':'app.bundle.js.LICENSE.txt'},{'revision':'8f96620b23485d3fc69e766f2379e29d','url':'app.css'},{'revision':'2197df47c49b6fc88a652fc3bfd61837','url':'app.webmanifest'},{'revision':'7f9ba545b35c98305663d47a9c5c96dc','url':'favicon.png'},{'revision':'7f9ba545b35c98305663d47a9c5c96dc','url':'images/logo.png'},{'revision':'8cafb30ad735a75404115e1d68fae087','url':'images/orange-background.png'},{'revision':'7ca016b4bd62f941b89e40f796aeac56','url':'images/placeholder-image.jpg'},{'revision':'f8fac8757b0f6f92c0c44e807f86cc26','url':'index.html'}]||[]),r((({url:e})=>"https://fonts.googleapis.com"===e.origin),new c({cacheName:"google-fonts-stylesheets",plugins:[new d({maxEntries:20,maxAgeSeconds:31536e3})]})),r((({url:e})=>"https://fonts.gstatic.com"===e.origin),new c({cacheName:"google-fonts-webfonts",plugins:[new p({statuses:[0,200]}),new d({maxEntries:30,maxAgeSeconds:31536e3})]})),r((({url:e})=>e.hostname.includes("cdnjs.cloudflare.com")&&e.pathname.includes("font-awesome")),new c({cacheName:"font-awesome-cdn",plugins:[new d({maxEntries:20,maxAgeSeconds:31536e3})]})),r((({url:e})=>e.hostname.includes("ui-avatars.com")),new c({cacheName:"ui-avatars",plugins:[new p({statuses:[0,200]}),new d({maxEntries:60,maxAgeSeconds:2592e3})]})),r((({request:e,url:t})=>{try{if((e.headers.get("accept")||"").includes("application/json"))return!0}catch(e){}return!!t.pathname.endsWith(".json")||!!t.pathname.includes("/api/")}),new l({cacheName:"api-json",plugins:[new p({statuses:[0,200]}),new d({maxEntries:60,maxAgeSeconds:86400})]})),r((({request:e})=>"navigate"===e.mode),i("/index.html")),r((({request:e,url:t})=>{if("image"===e.destination){if(t.pathname.includes("/images")||t.pathname.includes("/uploads")||t.pathname.includes("/media"))return!0;if(t.hostname&&t.hostname.includes("citycare"))return!0}return!1}),new u({cacheName:"api-images",plugins:[new d({maxEntries:100,maxAgeSeconds:2592e3})]})),r((({url:e})=>e.hostname.includes("maptiler")&&e.pathname.toLowerCase().includes("geocoding")),new c({cacheName:"maptiler-geocoding",plugins:[new p({statuses:[0,200]}),new d({maxEntries:50,maxAgeSeconds:31536e3})]})),self.addEventListener("push",(function(e){let t={};try{e.data&&(t=e.data.json())}catch(n){t={title:"Notifikasi",options:{body:e.data?e.data.text():"Ada notifikasi baru"}}}const n=t.title||"CeritaDunia",o=t.options||{};e.waitUntil(self.registration.showNotification(n,o))})),self.addEventListener("notificationclick",(function(e){e.notification.close();const t=new URL("/",self.location.origin).href;e.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then((e=>{for(const n of e)if(n.url===t&&"focus"in n)return n.focus();if(clients.openWindow)return clients.openWindow(t)})))}));const g="sync-queue";function h(){return new Promise(((e,t)=>{const n=indexedDB.open("ceritadunia-sync-db",1);n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(g)||t.createObjectStore(g,{keyPath:"id"})},n.onsuccess=t=>e(t.target.result),n.onerror=e=>t(e.target.error)}))}async function w(e){const t=await h();return new Promise(((n,o)=>{const a=t.transaction(g,"readwrite").objectStore(g).delete(e);a.onsuccess=()=>n(!0),a.onerror=()=>o(a.error)}))}self.addEventListener("sync",(function(e){"sync-stories"===e.tag&&e.waitUntil((async()=>{const e=await async function(){const e=await h();return new Promise(((t,n)=>{const o=e.transaction(g,"readonly").objectStore(g).getAll();o.onsuccess=()=>t(o.result||[]),o.onerror=()=>n(o.error)}))}();for(const t of e)await m(t)&&await w(t.id)})())}))})();